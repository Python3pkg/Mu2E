<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Prepping Data &mdash; Mu2E 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Mu2E 1.0.0 documentation" href="index.html" />
    <link rel="next" title="Mu2e Plotting Documentation" href="mu2eplots.html" />
    <link rel="prev" title="The Mu2E Magnetic Fields" href="field_view.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="prepping-data">
<h1>Prepping Data<a class="headerlink" href="#prepping-data" title="Permalink to this headline">¶</a></h1>
<p>The data used in this mu2e package must be formatted as a valid pandas DataFrame. To accomplish this,
the <cite>dataframeprod.py</cite> module has a useful class for taking a csv-like magnetic field simulation
and converting it to a DF, along with some additional column creation.</p>
<p>There is also a small helper function to convert a ROOT file to a DF, for particle trapping simulation studies.</p>
<div class="section" id="module-mu2e.dataframeprod">
<span id="the-dataframeprod-module"></span><h2>The <cite>dataframeprod</cite> Module<a class="headerlink" href="#module-mu2e.dataframeprod" title="Permalink to this headline">¶</a></h2>
<p>Module for converting Mu2e data into DataFrames.</p>
<p>This module defines classes and functions that takes Mu2E-style input files, typically csv or ROOT
files, and generates pandas DataFrames for use in this Python Mu2E package.  This module can also
save the output DataFrames as compressed cPickle files.  The input and output data are saved to a
subdir of the user-defined <cite>mu2e_ext_path</cite>, and are not committed to github.</p>
<p class="rubric">Example</p>
<p>Using the DataFrameMaker class:</p>
<div class="highlight-default"><div class="highlight"><pre>$ from mu2e.dataframeprod import DataFrameMaker
$ from mu2e import mu2e_ext_path
$ print mu2e_ext_path
&#39;/User/local/local_data&#39;
$ df = DataFrameMaker(mu2e_ext_path+&#39;datafiles/FieldMapsGA02/Mu2e_DS_GA0&#39;,
use_pickle=True, field_map_version=&#39;GA02&#39;).data_frame
$ print df.head()
...    X       Y       Z        Bx        By        Bz            R          ...    0 -1200.0 -1200.0  3071.0  0.129280  0.132039  0.044327  1697.056275
...    1 -1200.0 -1200.0  3096.0  0.132106  0.134879  0.041158  1697.056275
...    2 -1200.0 -1200.0  3121.0  0.134885  0.137670  0.037726  1697.056275
...    3 -1200.0 -1200.0  3146.0  0.137600  0.140397  0.034024  1697.056275
...     4 -1200.0 -1200.0  3171.0  0.140235  0.143042  0.030045  1697.056275

...    Phi      Bphi        Br
...    0 -2.356194 -0.001951 -0.184780
...    1 -2.356194 -0.001960 -0.188787
...    2 -2.356194 -0.001969 -0.192725
...    3 -2.356194 -0.001977 -0.196573
...    4 -2.356194 -0.001985 -0.200307
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Update the particle trapping function with something more flexible.</li>
</ul>
</div>
<p><em>2016 Brian Pollack, Northwestern University</em></p>
<p><a class="reference external" href="mailto:brianleepollack&#37;&#52;&#48;gmail&#46;com">brianleepollack<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<dl class="class">
<dt id="mu2e.dataframeprod.DataFrameMaker">
<em class="property">class </em><code class="descclassname">mu2e.dataframeprod.</code><code class="descname">DataFrameMaker</code><span class="sig-paren">(</span><em>file_name</em>, <em>header_names=None</em>, <em>use_pickle=False</em>, <em>field_map_version='Mau9'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a FieldMap csv into a pandas DataFrame.</p>
<p>It is assumed that the plaintext is formatted as a csv file, with comma or space delimiters.</p>
<ul class="simple">
<li>The expected headers are: &#8216;X Y Z Bx By Bz&#8217;</li>
<li>The DataFrameMaker converts these into <cite>pandas</cite> DFs, where each header is its own row, as</li>
</ul>
<p>expected.
* The input must be in units of mm and T (certain GA maps are hard-coded to convert to mm).
* Offsets in the X direction are applied if specified.
* If the map only covers one region of Y, the map is doubled and reflected about Y, such that
Y-&gt;-Y and
By-&gt;-By.
* The following columns are constructed and added to the DF by default: &#8216;R Phi Br Bphi&#8217;</p>
<p>The outputs should be saved as compressed pickle files, and should be loaded from those files
for further use.  Each pickle contains a single DF.</p>
<dl class="attribute">
<dt id="mu2e.dataframeprod.DataFrameMaker.file_name">
<code class="descname">file_name</code><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.file_name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; File path and name, no suffix.</p>
</dd></dl>

<dl class="attribute">
<dt id="mu2e.dataframeprod.DataFrameMaker.field_map_version">
<code class="descname">field_map_version</code><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.field_map_version" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; Mau or GA simulation type.</p>
</dd></dl>

<dl class="attribute">
<dt id="mu2e.dataframeprod.DataFrameMaker.data_frame">
<code class="descname">data_frame</code><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pandas.DataFrame</em> &#8211; Output DF.</p>
</dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.do_basic_modifications">
<code class="descname">do_basic_modifications</code><span class="sig-paren">(</span><em>offset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.do_basic_modifications"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.do_basic_modifications" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the field map to add more columns, offset the X axis so it is re-centered to 0,
and reflect the map about the Y-axis, if applicable.</p>
<ul class="simple">
<li>Default offset is 0.</li>
<li>The PS offset is +3904 (for Mau).</li>
<li>The DS offset is -3896 (for Mau).</li>
</ul>
<p>GA field maps are converted from meters to millimeters.</p>
</dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.make_bottom_half">
<code class="descname">make_bottom_half</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.make_bottom_half"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.make_bottom_half" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.make_br">
<code class="descname">make_br</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.make_br"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.make_br" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.make_dump">
<code class="descname">make_dump</code><span class="sig-paren">(</span><em>suffix=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.make_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.make_dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.make_r">
<code class="descname">make_r</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.make_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.make_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mu2e.dataframeprod.DataFrameMaker.make_theta">
<code class="descname">make_theta</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#DataFrameMaker.make_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.DataFrameMaker.make_theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="mu2e.dataframeprod.g4root_to_df">
<code class="descclassname">mu2e.dataframeprod.</code><code class="descname">g4root_to_df</code><span class="sig-paren">(</span><em>input_name</em>, <em>make_pickle=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mu2e/dataframeprod.html#g4root_to_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mu2e.dataframeprod.g4root_to_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick converter for virtual detector ROOT files from the Mu2E Art Framework.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_name</strong> &#8211; file path name without suffix.</li>
<li><strong>make_pickle</strong> &#8211; no dfs are returned, and a pickle is created containing a tuple of the</li>
<li><strong>dfs.</strong> (<em>relevant</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple of dataframes, or none.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Mu2E</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Mu2E Experiment Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="field_view.html">The Mu2E Magnetic Fields</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Prepping Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mu2e.dataframeprod">The <cite>dataframeprod</cite> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mu2eplots.html">Mu2e Plotting Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="field_view.html" title="previous chapter">The Mu2E Magnetic Fields</a></li>
      <li>Next: <a href="mu2eplots.html" title="next chapter">Mu2e Plotting Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Brian Pollack.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/dataframeprod.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>